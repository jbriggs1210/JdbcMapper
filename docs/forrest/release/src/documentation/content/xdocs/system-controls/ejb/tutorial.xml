<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V2.0//EN" "http://forrest.apache.org/dtd/document-v20.dtd">
<document>
    <header>
        <title>EJB Control Tutorial</title>
    </header>
    <body>
        <section>
            <title>Overview</title>
            <p>The EJB Control is an extensible control, and you do not use it directly. To create an EJB control
                    for an EJB, you would create a control extending the EJB Control. An extended EJB control can
                    only represent one EJB, so you must create one for each EJB.
            </p>
    </section>
    <section>
            <title>Extending the EJB Control</title>
            <ol>
                    <li>Create a Java interface extending the appropriate EJB Control interface. If the EJB is a
                            session bean, you must extend <code>org.apache.beehive.controls.system.ejb.SessionEJBControl</code>, or if it is an
                            entity bean, extend <code>org.apache.beehive.controls.system.ejb.EntityEJBControl</code>.</li>

                    <li>Annotate the Java interface with <code>@ControlExtension</code>
                            (<code>org.apache.beehive.controls.api.bean.ControlExtension</code>), so the Control Annotation
                            Processor will know that the Java interface is a control extension.</li>

                    <li>Have the Java interface also extend the EJB's home and business interfaces. The
                            business interface may either by the EJB's local interface or the remote interface.</li>

                    <li>Specifiy how the EJB control should lookup the EJB. To lookup the EJB by its JNDI name,
                            set the EJB control's @EJBHome.jndiName annotation to the EJB's JNDI name. To lookup
                            the EJB using an EJB link, set the EJB control's <code>@EJBHome.ejbLink</code> annotation to the name
                            of the EJB link.</li>

                    <li>If the EJB control uses JNDI to look up an EJB, you may optionally specify the JNDI context
                            environment properties using the <code>@JNDIContextEnv</code> annotation.</li>
            </ol>
    </section>
    <section>
        <title>EJB Control Extension Examples</title>
        <section>
            <title>Session Bean EJB Control Example</title>
            <p>This code is part of the EJB Control samples that is available in the samples directory of the
                Beehive source tree. This sample demonstrates an EJB control for a session bean.</p>

        <source>
package org.apache.beehive.controls.system.ejb.sample.control;

import org.apache.beehive.controls.api.bean.ControlExtension;
import org.apache.beehive.controls.system.ejb.SessionEJBControl;
import org.apache.beehive.controls.system.ejb.EJBControl.EJBHome;
import org.apache.beehive.controls.system.ejb.EJBControl.JNDIContextEnv;
import org.apache.beehive.controls.system.ejb.sample.bean.HelloHome;
import org.apache.beehive.controls.system.ejb.sample.bean.HelloRemote;

@ControlExtension
@EJBHome(jndiName="org.apache.beehive.controls.system.ejb.sample.HelloHome")
@JNDIContextEnv(
        contextFactory="weblogic.jndi.WLInitialContextFactory",
        providerURL="t3://localhost:7001",
        principal="manager",
        credentials="manager")
public interface HelloEJBControl
    extends SessionEJBControl, HelloHome, HelloRemote {
}
            </source>

        </section>

        <section>
            <title>Entity Bean EJB Control Example</title>
            <p>This sample demonstrates an EJB control for a entity bean.</p>

             <source>
package org.apache.beehive.controls.system.ejb.sample.control;

import org.apache.beehive.controls.api.bean.ControlExtension;
import org.apache.beehive.controls.system.ejb.EntityEJBControl;
import org.apache.beehive.controls.system.ejb.EJBControl.EJBHome;
import com.mycompany.MyEntityBeanHome;
import com.mycompany.MyEntityBeanRemote;

@ControlExtension
@EJBHome(jndiName="com.mycompany.MyEntityBeanHome")
public interface MyEJBControl
    extends EntityEJBControl, MyEntityBeanHome, MyEntityBeanRemote {
}
            </source>

        </section>
        </section>
    </body>
</document>
