<?xml version="1.0"?>

<project name="Beehive/NetUI/Test" default="drt" basedir=".">
    
    <import file="netui-test-imports.xml"/>

    <property name="drt.testResults.dir" location="${beehive.home}/netui/build/junit-drt.testResults"/>
    <property name="bvt.testResults.dir" location="${beehive.home}/netui/build/junit-bvt.testResults"/>
    <property name="compiler.testResults.dir" location="${beehive.home}/netui/build/compiler.testResults"/>

    <target name="prepare">
        <mkdir dir="${test.lib.dir}"/>
    </target>

    <!-- ============================================= -->
    <!-- Build Targets                                 -->
    <!-- ============================================= -->
    <target name="build" depends="prepare" description="Build the QA modules">
        <antcall target="do.subant">
            <param name="target.name" value="build"/>
        </antcall>
    </target>

    <target name="clean" description="Clean the QA modules">
        <antcall target="do.subant">
            <param name="target.name" value="clean"/>
        </antcall>

    	<delete dir="${drt.testResults.dir}"/>
    	<delete dir="${bvt.testResults.dir}"/>
    	<delete dir="${compiler.testResults.dir}"/>
    </target>

    <target name="do.subant">
        <subant target="${target.name}">
            <filelist dir="${test.src.dir}">
                <file name="junitTests"/>
                <file name="compilerTests"/>
            </filelist>
        </subant>
    </target>

    <!-- ============================================= -->
    <!-- DRT Targets                                   -->
    <!-- ============================================= -->
    <target name="drt" depends="clean,build,junit.drt" description="Run the NetUI JUnit DRTs"/>
    <target name="bvt" depends="clean,build,junit.bvt,compiler.bvt" description="Run the NetUI JUnit BVTs"/>

    <target name="junit.drt">
        <ant antfile="junitCore.xml" target="run.tests" inheritAll="false">
            <property name="testout.dir" location="${drt.testResults.dir}"/>
            <property name="formatter.type" value="xml"/>
            <property name="fail" value="true"/>
        </ant>
    </target>

    <target name="junit.bvt">
        <ant antfile="junitCore.xml" target="run.tests" inheritAll="false">
            <property name="testout.dir" location="${bvt.testResults.dir}"/>
            <property name="formatter.type" value="xml"/>
            <property name="fail" value="false"/>
        </ant>
    </target>

    <target name="compiler.bvt" description="Runs the Compiler BVT suite">
        <ant antfile="junitCore.xml" target="run.compiler.tests" inheritAll="false">
            <property name="testout.dir" location="${compiler.testResults.dir}"/>
            <property name="formatter.type" value="xml"/>
            <property name="fail" value="false"/>
        </ant>
    </target>

</project>
